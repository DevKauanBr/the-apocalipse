const noah=document.querySelector(".noah");let cenario=document.querySelector(".cenario"),fala=document.querySelector(".fala"),npc1=document.querySelector(".npc1"),diag=document.querySelector(".diag"),titulodiag=document.querySelector("#titulodiag"),textodiag=document.querySelector("#textodiag"),bg=document.querySelector("#bg"),textobg=document.querySelector("#textobg"),psp=1,mapa=1,movimentação=!0,showcordenadas=!1,colisão=!0,hora="noite",conversando=!1;const passo=new Audio("assets/outros/passo.mp3"),somambienteNoite=new Audio("assets/outros/somambienteNoite.mp3");function dialogo(e){if("sim"==e)1==mapa&&(fala.style.display="none",carregarMapa(2));else{if("exit"==e)return void(diag.style.display="none");1==mapa&&(fala.style.display="none",movimentação=!0)}}function esperar(e){return new Promise((o=>setTimeout(o,e)))}async function carregarMapa(e){switch(e){case 2:localStorage.setItem("save","2"),movimentação=!1,mapa=2,psp=3,cenario.src="assets/sprites/Prototipo_do_Kawan2.png",noah.style.left="126px",noah.style.bottom="182px",npc1.style.opacity="100%",somambienteNoite.pause(),await esperar(2e3),diag.style.display="inline",titulodiag.innerText="Noah diz:",textodiag.innerText="Irmã? Ana? Ei! Está tudo bem?",await esperar(3e3),npc1.src="assets/sprites/anaPos4.png",await esperar(2e3),diag.style.display="inline",titulodiag.innerText="Ana:",textodiag.innerText="Craaarrara",await esperar(4e3),diag.style.display="inline",titulodiag.innerText="Noah se assusta:",textodiag.innerText="!",textodiag.style.color="red",await esperar(3e3),npc1.classList.add("anaandar"),await esperar(3e3),npc1.classList.remove("anaandar"),npc1.style.left="200px",await esperar(2e3),bg.style.display="inline",hora=".",somambienteNoite.pause(),textobg.style.marginTop="150px",textobg.innerText="Noah correu até sentir que suas pernas não podiam mais suportar seu peso. A angústia o consumia, um vazio profundo e doloroso, pois acabara de perder alguém que amava profundamente...",await esperar(1e4),textobg.innerText="",bg.style.display="none",localStorage.setItem("save","3"),Load();break;case 3:localStorage.setItem("save","3"),movimentação=!0,mapa=3,psp=4,cenario.src="assets/sprites/Prototipo_do_Kawan4.png",noah.style.left="560px",noah.style.bottom="175px",npc1.style.opacity="0%",hora="noite",somambienteNoite.play();break;case 4:movimentação=!0,mapa=4,psp=4,cenario.src="assets/sprites/Prototipo_do_Kawan3.png",noah.style.left="560px",noah.style.bottom="175px",npc1.style.opacity="0%",hora="noite",somambienteNoite.play(),alert("Atenção!\n\nEstá é uma versão de teste do jogo. Por esse motivo a partir daqui poderá surgir bugs durante a gameplay!\n\nAnteciosamente, Equipe KAYOFFICE.")}}function Colisão(){if(0!=colisão)if(1==mapa){let e=+window.getComputedStyle(noah).left.replace("px",""),o=+window.getComputedStyle(noah).bottom.replace("px","");if(e<=154&&(noah.style.left="154px"),e>=490&&(noah.style.left="490px"),o<=140&&(noah.style.bottom="140px"),o>=294&&(noah.style.bottom="294px"),o<=224&&o>=168&&e>=455&&(pos=3)){document.querySelector(".fala").style.display="inline",movimentação=!1}}else if(3==mapa){let e=+window.getComputedStyle(noah).left.replace("px",""),o=+window.getComputedStyle(noah).bottom.replace("px","");o>=189&&(noah.style.bottom="189px"),o<=168&&(noah.style.bottom="168px"),e>=574&&(noah.style.left="574px"),-7==e&&(mapa=4,carregarMapa(4))}}function Load(){let e=localStorage.getItem("save");null==e&&localStorage.setItem("save","1"),1==e?(psp=1,mapa=1,movimentação=!0,colisão=!0,hora="noite"):2==e?carregarMapa(2):3==e&&carregarMapa(3)}function resetsave(){localStorage.setItem("save","1"),Load()}document.addEventListener("keydown",(e=>{if(0==movimentação)return;let o=e.key;if("w"==o){let e=+window.getComputedStyle(noah).bottom.replace("px","");noah.style.bottom=`${e+7}px`,psp=2,Colisão(),passo.play()}else if("s"==o){let e=+window.getComputedStyle(noah).bottom.replace("px","");noah.style.bottom=e-7+"px",psp=1,Colisão(),passo.play()}else if("a"==o){let e=+window.getComputedStyle(noah).left.replace("px","");noah.style.left=e-7+"px",psp=4,Colisão(),passo.play()}else if("d"==o){let e=+window.getComputedStyle(noah).left.replace("px","");noah.style.left=`${e+7}px`,psp=3,Colisão(),passo.play()}}));const loop=setInterval((()=>{if(1==psp?noah.src="assets/sprites/noahPos1.png":2==psp?noah.src="assets/sprites/noahPos2.png":3==psp?noah.src="assets/sprites/noahPos3.png":4==psp&&(noah.src="assets/sprites/noahPos4.png"),1==showcordenadas){let e=+window.getComputedStyle(noah).top.replace("px",""),o=+window.getComputedStyle(noah).bottom.replace("px",""),a=+window.getComputedStyle(noah).right.replace("px",""),t=+window.getComputedStyle(noah).left.replace("px","");console.clear(),console.log(`Topo: ${e}\nBaixo: ${o}\nDireita: ${a}\nEsquerda: ${t}`)}"noite"==hora?somambienteNoite.play():somambienteNoite.stop()}),10);Load();